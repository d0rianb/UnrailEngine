var t=Object.defineProperty,e=Object.defineProperties,s=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,a=(e,s,i)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i,o=(t,e)=>{for(var s in e||(e={}))n.call(e,s)&&a(t,s,e[s]);if(i)for(var s of i(e))l.call(e,s)&&a(t,s,e[s]);return t};"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;class c{static random(){return Math.random()}static randint(t,e){return Math.floor(t+Math.random()*(e-t))}static choice(t){return t[~~(c.random()*t.length)]}static bool(){return c.random()>.5}static sign(){return c.choice([-1,1])}static percent(t){return c.random()<t/100}}var r=c;class d{constructor(t,e){this.x=t,this.y=e}add(t){return new d(this.x+t.x,this.y+t.y)}clone(){return new d(this.x,this.y)}dist(t){return Math.sqrt((this.x-t.x)**2+(this.y-t.y)**2)}}const h=d,m=new d(0,0),p=new d(1,1);function u(t,e,s){return Math.max(t,Math.min(e,s))}function y(t,e,s){return u(e,t,s)===t}var b,x;(x=b||(b={}))[x.KeyboardPressed=0]="KeyboardPressed",x[x.KeyboardDown=1]="KeyboardDown",x[x.Mouse=2]="Mouse",x[x.Window=3]="Window",x[x.Custom=4]="Custom";class Z{constructor(t,e,s=4){this.name=t,this.callback=e,this.type=s,this.listeners=[this.callback]}static emit(t,e){const s=w.getCustomEvent(t);s&&s.listeners.forEach((t=>t(e)))}static on(t,e){const s=w.getCustomEvent(t);if(s)s.listeners.push(e);else{const s=new Z(t,e,4);w.addEvent(s)}}static onKeyDown(t,e){w.addEvent(new Z(t,e,1))}static onKeyPressed(t,e){w.addEvent(new Z(t,e,0))}static onMouseClick(t){w.addEvent(new Z("click",t,2))}}const w=new class{constructor(){this.windowEvents=[],this.keyboardDownEvents=[],this.keyboardPressedEvents=[],this.customEvents=[],this.currentKeyEvents=[]}init(){window.addEventListener("keydown",(t=>{this.currentKeyEvents.find((e=>e.code===t.code))||this.currentKeyEvents.push(t),this.keyboardPressedEvents.forEach((e=>{t.code===e.name&&e.callback(t)}))})),window.addEventListener("keyup",(t=>{this.currentKeyEvents.length&&(this.currentKeyEvents=this.currentKeyEvents.filter((e=>e.code!==t.code)))}))}addEvent(t){switch(t.type){case b.KeyboardDown:this.keyboardDownEvents.push(t);break;case b.KeyboardPressed:this.keyboardPressedEvents.push(t);break;case b.Mouse:break;case b.Window:this.windowEvents.push(t),this.bindEvents();break;case b.Custom:this.customEvents.push(t)}}getCustomEvent(t){return this.customEvents.find((e=>e.name===t))}bindEvents(){this.windowEvents.forEach((t=>window.addEventListener(t.name,t.callback)))}tick(){this.currentKeyEvents.length&&this.keyboardDownEvents.forEach((t=>{this.currentKeyEvents.forEach((e=>{e.code===t.name&&t.callback(e)}))}))}};var f,G={exports:{}},g=G.exports=((f=function(){function t(t){return i.appendChild(t.dom),t}function e(t){for(var e=0;e<i.children.length;e++)i.children[e].style.display=e===t?"block":"none";s=t}var s=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",(function(t){t.preventDefault(),e(++s%i.children.length)}),!1);var n=(performance||Date).now(),l=n,a=0,o=t(new f.Panel("FPS","#0ff","#002")),c=t(new f.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var r=t(new f.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:i,addPanel:t,showPanel:e,begin:function(){n=(performance||Date).now()},end:function(){a++;var t=(performance||Date).now();if(c.update(t-n,200),t>l+1e3&&(o.update(1e3*a/(t-l),100),l=t,a=0,r)){var e=performance.memory;r.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){n=this.end()},domElement:i,setMode:e}}).Panel=function(t,e,s){var i=1/0,n=0,l=Math.round,a=l(window.devicePixelRatio||1),o=80*a,c=48*a,r=3*a,d=2*a,h=3*a,m=15*a,p=74*a,u=30*a,y=document.createElement("canvas");y.width=o,y.height=c,y.style.cssText="width:80px;height:48px";var b=y.getContext("2d");return b.font="bold "+9*a+"px Helvetica,Arial,sans-serif",b.textBaseline="top",b.fillStyle=s,b.fillRect(0,0,o,c),b.fillStyle=e,b.fillText(t,r,d),b.fillRect(h,m,p,u),b.fillStyle=s,b.globalAlpha=.9,b.fillRect(h,m,p,u),{dom:y,update:function(c,x){i=Math.min(i,c),n=Math.max(n,c),b.fillStyle=s,b.globalAlpha=1,b.fillRect(0,0,o,m),b.fillStyle=e,b.fillText(l(c)+" "+t+" ("+l(i)+"-"+l(n)+")",r,d),b.drawImage(y,h+a,m,p-a,u,h,m,p-a,u),b.fillRect(h+p-a,m,a,u),b.fillStyle=s,b.globalAlpha=.9,b.fillRect(h+p-a,m,a,l((1-c/x)*u))}}},f);function C(){return{width:window.innerWidth,height:window.innerHeight}}function W(t,e,s,i){const n=s||window.devicePixelRatio||1,l=document.createElement("canvas");return l.width=t*n,l.height=e*n,l.style.width=t+"px",l.style.height=e+"px",1!=n&&l.getContext("2d").setTransform(n,0,0,n,0,0),i&&(l.oncontextmenu=t=>t.preventDefault()),l}function L(t,e){window.onload=()=>{let s=document.querySelector(e);s||(s=document.createElement(e)),s.appendChild(t),document.querySelector("body").appendChild(s)}}const S={strokeStyle:"black",lineWidth:2,lineJoin:"round",fillStyle:"transparent",globalAlpha:1,globalCompositeOperation:"add"},v=2*Math.PI;let X,R,k,K,Y=null==self.document&&null==self.window?4:2*(window.devicePixelRatio||1);function N(t){return~~(t*Y)/Y}class H{static create(t,e){const s=W(t,e);return L(s,"main"),H.setContext(s.getContext("2d")),s}static setContext(t){X=t}static getContext(){return X}static style(t){if(!X)throw new Error("Context has not been initialize. Please use Renderer.setContext");const e=o(o({},S),t);for(let s in e)X[s]!==e[s]&&(X[s]=e[s])}static clear(t){t?(H.style({fillStyle:t}),X.fillRect(0,0,X.canvas.width,X.canvas.height)):X.clearRect(0,0,X.canvas.width,X.canvas.height)}static line(t,e,s,i,n){H.style(n),X.beginPath(),X.moveTo(N(t),N(e)),X.lineTo(N(s),N(i)),X.stroke()}static rect(t,e,s,i,n,l){l||H.style(n);const[a,o,c,r]=[N(t),N(e),N(s),N(i)];X.fillRect(a,o,c,r),X.strokeRect(a,o,c,r)}static poly(t,e){if(t.length){H.style(e),X.beginPath(),X.moveTo(N(t[0].x),N(t[0].y));for(let e=1;e<t.length;e++)X.lineTo(N(t[e].x),N(t[e].y));X.stroke()}}static circle(t,e,s,i){H.style(i),X.beginPath(),X.arc(N(t),N(e),s,0,v),X.stroke()}static point(t,e,s){H.circle(t,e,5,s)}static rectSprite(t,e,s,i,n){H.style({}),X.save(),X.translate(N(t+s/2),N(e+i/2)),X.scale(n.scale.x,n.scale.y),X.rotate(n.rotation),X.drawImage(n.image,N(s*n.offset.x-s/2),N(i*n.offset.y-i/2),N(s),N(i)),X.restore()}static circleSprite(t,e,s,i){X.save(),X.beginPath(),X.arc(N(t),N(e),s,0,v),X.clip(),H.rectSprite(t-s,e-s,2*s,2*s,i),X.restore()}static tint(t,e,s,i,n){H.rect(e,s,i,n,{fillStyle:t,globalCompositeOperation:"multiply",globalAlpha:.25})}static beginFrame(){}static endFrame(){}}class V{constructor(t,e){this.title=t,this.content=e}}class E{constructor(t,e){this.methodName=t,this.args=e}}function I(){return new Worker("data:application/javascript;base64,dmFyIGU9T2JqZWN0LmRlZmluZVByb3BlcnR5LHQ9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyxzPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksYT1PYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLGk9KHQscyxhKT0+cyBpbiB0P2UodCxzLHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMCx2YWx1ZTphfSk6dFtzXT1hLHI9KGUscik9Pntmb3IodmFyIG4gaW4gcnx8KHI9e30pKXMuY2FsbChyLG4pJiZpKGUsbixyW25dKTtpZih0KWZvcih2YXIgbiBvZiB0KHIpKWEuY2FsbChyLG4pJiZpKGUsbixyW25dKTtyZXR1cm4gZX07Y29uc3Qgbj17c3Ryb2tlU3R5bGU6ImJsYWNrIixsaW5lV2lkdGg6MixsaW5lSm9pbjoicm91bmQiLGZpbGxTdHlsZToidHJhbnNwYXJlbnQiLGdsb2JhbEFscGhhOjEsZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uOiJhZGQifSxvPTIqTWF0aC5QSTtsZXQgbCxjPW51bGw9PXNlbGYuZG9jdW1lbnQmJm51bGw9PXNlbGYud2luZG93PzQ6Miood2luZG93LmRldmljZVBpeGVsUmF0aW98fDEpO2Z1bmN0aW9uIGgoZSl7cmV0dXJufn4oZSpjKS9jfWNsYXNzIGR7c3RhdGljIGNyZWF0ZShlLHQpe2NvbnN0IHM9ZnVuY3Rpb24oZSx0LHMsYSl7Y29uc3QgaT1zfHx3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpb3x8MSxyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpO3JldHVybiByLndpZHRoPWUqaSxyLmhlaWdodD10Kmksci5zdHlsZS53aWR0aD1lKyJweCIsci5zdHlsZS5oZWlnaHQ9dCsicHgiLDEhPWkmJnIuZ2V0Q29udGV4dCgiMmQiKS5zZXRUcmFuc2Zvcm0oaSwwLDAsaSwwLDApLGEmJihyLm9uY29udGV4dG1lbnU9ZT0+ZS5wcmV2ZW50RGVmYXVsdCgpKSxyfShlLHQpO3JldHVybiBmdW5jdGlvbihlLHQpe3dpbmRvdy5vbmxvYWQ9KCk9PntsZXQgcz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKHQpO3N8fChzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodCkpLHMuYXBwZW5kQ2hpbGQoZSksZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiYm9keSIpLmFwcGVuZENoaWxkKHMpfX0ocywibWFpbiIpLGQuc2V0Q29udGV4dChzLmdldENvbnRleHQoIjJkIikpLHN9c3RhdGljIHNldENvbnRleHQoZSl7bD1lfXN0YXRpYyBnZXRDb250ZXh0KCl7cmV0dXJuIGx9c3RhdGljIHN0eWxlKGUpe2lmKCFsKXRocm93IG5ldyBFcnJvcigiQ29udGV4dCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZS4gUGxlYXNlIHVzZSBSZW5kZXJlci5zZXRDb250ZXh0Iik7Y29uc3QgdD1yKHIoe30sbiksZSk7Zm9yKGxldCBzIGluIHQpbFtzXSE9PXRbc10mJihsW3NdPXRbc10pfXN0YXRpYyBjbGVhcihlKXtlPyhkLnN0eWxlKHtmaWxsU3R5bGU6ZX0pLGwuZmlsbFJlY3QoMCwwLGwuY2FudmFzLndpZHRoLGwuY2FudmFzLmhlaWdodCkpOmwuY2xlYXJSZWN0KDAsMCxsLmNhbnZhcy53aWR0aCxsLmNhbnZhcy5oZWlnaHQpfXN0YXRpYyBsaW5lKGUsdCxzLGEsaSl7ZC5zdHlsZShpKSxsLmJlZ2luUGF0aCgpLGwubW92ZVRvKGgoZSksaCh0KSksbC5saW5lVG8oaChzKSxoKGEpKSxsLnN0cm9rZSgpfXN0YXRpYyByZWN0KGUsdCxzLGEsaSxyKXtyfHxkLnN0eWxlKGkpO2NvbnN0W24sbyxjLHVdPVtoKGUpLGgodCksaChzKSxoKGEpXTtsLmZpbGxSZWN0KG4sbyxjLHUpLGwuc3Ryb2tlUmVjdChuLG8sYyx1KX1zdGF0aWMgcG9seShlLHQpe2lmKGUubGVuZ3RoKXtkLnN0eWxlKHQpLGwuYmVnaW5QYXRoKCksbC5tb3ZlVG8oaChlWzBdLngpLGgoZVswXS55KSk7Zm9yKGxldCB0PTE7dDxlLmxlbmd0aDt0KyspbC5saW5lVG8oaChlW3RdLngpLGgoZVt0XS55KSk7bC5zdHJva2UoKX19c3RhdGljIGNpcmNsZShlLHQscyxhKXtkLnN0eWxlKGEpLGwuYmVnaW5QYXRoKCksbC5hcmMoaChlKSxoKHQpLHMsMCxvKSxsLnN0cm9rZSgpfXN0YXRpYyBwb2ludChlLHQscyl7ZC5jaXJjbGUoZSx0LDUscyl9c3RhdGljIHJlY3RTcHJpdGUoZSx0LHMsYSxpKXtkLnN0eWxlKHt9KSxsLnNhdmUoKSxsLnRyYW5zbGF0ZShoKGUrcy8yKSxoKHQrYS8yKSksbC5zY2FsZShpLnNjYWxlLngsaS5zY2FsZS55KSxsLnJvdGF0ZShpLnJvdGF0aW9uKSxsLmRyYXdJbWFnZShpLmltYWdlLGgocyppLm9mZnNldC54LXMvMiksaChhKmkub2Zmc2V0LnktYS8yKSxoKHMpLGgoYSkpLGwucmVzdG9yZSgpfXN0YXRpYyBjaXJjbGVTcHJpdGUoZSx0LHMsYSl7bC5zYXZlKCksbC5iZWdpblBhdGgoKSxsLmFyYyhoKGUpLGgodCkscywwLG8pLGwuY2xpcCgpLGQucmVjdFNwcml0ZShlLXMsdC1zLDIqcywyKnMsYSksbC5yZXN0b3JlKCl9c3RhdGljIHRpbnQoZSx0LHMsYSxpKXtkLnJlY3QodCxzLGEsaSx7ZmlsbFN0eWxlOmUsZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uOiJtdWx0aXBseSIsZ2xvYmFsQWxwaGE6LjI1fSl9c3RhdGljIGJlZ2luRnJhbWUoKXt9c3RhdGljIGVuZEZyYW1lKCl7fX1uZXcgY2xhc3MgZXh0ZW5kcyBjbGFzc3tzZW5kTWVzc2FnZVRvTWFpblRocmVhZChlLHQpe3NlbGYucG9zdE1lc3NhZ2Uoe3RpdGxlOmUsZGF0YTp0fSl9bG9nKC4uLmUpe3RoaXMuc2VuZE1lc3NhZ2VUb01haW5UaHJlYWQoImxvZyIsLi4uZSl9fXtjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5jYW52YXNSZXNvbHV0aW9uPTEsdGhpcy5vZmZzY3JlZW5DYW52YXM9bnVsbCx0aGlzLmN0eD1udWxsLHRoaXMudGV4dHVyZUFsaWFzPW5ldyBNYXAsc2VsZi5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwoKHtkYXRhOmV9KT0+dGhpcy5vbk1lc3NhZ2UoZS50aXRsZSxlLmNvbnRlbnQpKSl9b25NZXNzYWdlKGUsdCl7c3dpdGNoKGUpe2Nhc2UiaW5pdENhbnZhcyI6dGhpcy5vZmZzY3JlZW5DYW52YXM9dC5jYW52YXMsdGhpcy5jdHg9dGhpcy5vZmZzY3JlZW5DYW52YXMuZ2V0Q29udGV4dCgiMmQiKSxkLnNldENvbnRleHQodGhpcy5jdHgpLHRoaXMuc2V0U2l6ZSh0LmRwcix0LndpZHRoLHQuaGVpZ2h0KSx0aGlzLnNlbmRNZXNzYWdlVG9NYWluVGhyZWFkKCJpbml0aWFsaXplZCIpO2JyZWFrO2Nhc2UicmVuZGVyIjpmb3IobGV0IGUgb2YgdC5yZW5kZXJTdGFjayl0aGlzLmhhbmRsZURyYXdSZXF1ZXN0KGUubWV0aG9kTmFtZSxlLmFyZ3MpO2JyZWFrO2Nhc2UibmV3VGV4dHVyZSI6dGhpcy50ZXh0dXJlQWxpYXNbdC5pZF09dC50ZXh0dXJlfX1zZXRTaXplKGUsdCxzKXtjb25zdCBhPShlfHwxKSp0aGlzLmNhbnZhc1Jlc29sdXRpb247dGhpcy5vZmZzY3JlZW5DYW52YXMud2lkdGg9dCphLHRoaXMub2Zmc2NyZWVuQ2FudmFzLmhlaWdodD1zKmEsInNldFRyYW5zZm9ybSJpbiB0aGlzLmN0eCYmdGhpcy5jdHguc2V0VHJhbnNmb3JtKGEsMCwwLGEsMCwwKX1nZXRUZXh0dXJlKGUpe3JldHVybiB0aGlzLnRleHR1cmVBbGlhc1tlXX1oYW5kbGVEcmF3UmVxdWVzdChlLHQpe3N3aXRjaChlKXtjYXNlInN0eWxlIjpkLnN0eWxlKG51bGw9PXQ/dm9pZCAwOnQub2JqKTticmVhaztjYXNlImNsZWFyIjpkLmNsZWFyKG51bGw9PXQ/dm9pZCAwOnQuY29sb3IpO2JyZWFrO2Nhc2UibGluZSI6ZC5saW5lKHQueDEsdC55MSx0LngyLHQueTIsdC5vYmopO2JyZWFrO2Nhc2UicmVjdCI6ZC5yZWN0KHQueCx0LnksdC53aWR0aCx0LmhlaWdodCx0Lm9iaik7YnJlYWs7Y2FzZSJwb2x5IjpkLnBvbHkodC5wb2ludHMsdC5vYmopO2JyZWFrO2Nhc2UiY2lyY2xlIjpkLmNpcmNsZSh0LngsdC55LHQucmFkaXVzLHQub2JqKTticmVhaztjYXNlInBvaW50IjpkLnBvaW50KHQueCx0LnksdC5vYmopO2JyZWFrO2Nhc2UicmVjdFNwcml0ZSI6ZC5yZWN0U3ByaXRlKHQueCx0LnksdC53aWR0aCx0LmhlaWdodCx0aGlzLmdldFRleHR1cmUodC50ZXh0dXJlSWQpKTticmVhaztjYXNlImNpcmNsZVNwcml0ZSI6ZC5jaXJjbGVTcHJpdGUodC54LHQueSx0LnJhZGl1cyx0aGlzLmdldFRleHR1cmUodC50ZXh0dXJlSWQpKTticmVhaztjYXNlInRpbnQiOmQudGludCh0LmNvbG9yLHQueCx0LnksdC53aWR0aCx0LmhlaWdodCl9fX07Cg==",{type:"module"})}let F=!1,J=[];const z=new Map;class M{static get worker(){return k}static get workerIsInitialized(){return F}static get offscreenCanvas(){return R}static get renderStack(){return J}static create(t,e){return K=W(t,e,1),M.initRenderWorker(K,t,e),L(K,"main"),K}static initRenderWorker(t,e,s){"offscreen"!==q.rendererType&&q.setRendererType("offscreen");let{clientWidth:i,clientHeight:n}=t;k=new I,R=t.transferControlToOffscreen(),this.sendMessageToWorker("initCanvas",{width:e||i,height:s||n,canvas:R,dpr:window.devicePixelRatio||1},[R]),k.onmessage=({data:{title:t,data:e}})=>{switch(t){case"log":console.log("message from the renderer worker : ",e);break;case"initialized":F=!0}}}static addRenderCall(t,e){J.push(new E(t,e||{}))}static sendMessageToWorker(t,e,s){return k.postMessage(new V(t,e),s||[])}static style(t){this.addRenderCall("style",{obj:t})}static clear(t){this.addRenderCall("clear",{color:t})}static line(t,e,s,i,n){this.addRenderCall("line",{x1:t,y1:e,x2:s,y2:i,obj:n})}static rect(t,e,s,i,n,l){this.addRenderCall("rect",{x:t,y:e,width:s,height:i,obj:n,noStyle:l})}static poly(t,e){this.addRenderCall("poly",{points:t,obj:e})}static circle(t,e,s,i){this.addRenderCall("circle",{x:t,y:e,radius:s,obj:i})}static point(t,e,s){this.addRenderCall("point",{x:t,y:e,obj:s})}static rectSprite(t,e,s,i,n){var l;z.has(n.id)?this.addRenderCall("rectSprite",{x:t,y:e,width:s,height:i,textureId:n.id}):null==(l=n.convertToBitmap())||l.then((t=>{z.set(n.id,t),this.sendMessageToWorker("newTexture",{id:n.id,texture:t})}))}static async circleSprite(t,e,s,i){var n;z.has(i.id)?this.addRenderCall("circleSprite",{x:t,y:e,radius:s,textureId:i.id}):null==(n=i.convertToBitmap())||n.then((t=>{z.set(i.id,t),this.sendMessageToWorker("newTexture",{id:i.id,texture:t})}))}static tint(t,e,s,i,n){this.addRenderCall("circle",{color:t,x:e,y:s,width:i,height:n})}static beginFrame(){J=[],this.addRenderCall("clear")}static endFrame(){F&&(this.sendMessageToWorker("render",{renderStack:J}),J=[])}}let Q=0;class U{constructor(t,e){if(!t)throw new Error("A source path to the resource must be provided");this.id=Q++,this.image=new Image,this.image.src=t,this.size=new d(this.image.width,this.image.height),this.options=e||{},this.rotation=this.options.rotation||0,this.offset=this.options.offset||m,this.scale=this.options.scale||p}async convertToBitmap(){if(!this.image.width||!this.image.height)return;const t=await createImageBitmap(this.image);return i=o({},this),e(i,s({image:t}));var i}}let T=[],j=4;const P=["top-left","top-right","bottom-left","bottom-right","custom"];class B{static addItem(t,e,s){B.internalAddItem(t,e,s)}static addButton(t,e,s,i){B.internalAddItem(t,e,s,i)}static internalAddItem(t,e,s,i){const n={callback:t,position:e,options:s,onClick:i};T.push(n);const l=T.length;window.addEventListener("load",(()=>B.addToDom(n,l)))}static init(){const t=document.createElement("div");t.classList.add("ue-interface","ue-container");for(let e of P){const s=document.createElement("div");s.classList.add(e),t.appendChild(s)}document.body.appendChild(t)}static addToDom(t,e){var s,i;const n=t.callback(),l=document.createElement("span");l.classList.add("ue-interface-items"),l.id=`item-${e}`,l.innerText=n,Object.entries(t.options||{}).forEach((([t,e])=>l.style[t]=e)),t.position?null==(s=document.querySelector(`.ue-container > .${t.position}`))||s.appendChild(l):null==(i=document.querySelector(".ue-container > .custom"))||i.appendChild(l),t.onClick&&(l.addEventListener("click",(e=>t.onClick(e))),l.classList.add("ue-interface-button"))}static update(){T.forEach(((t,e)=>{const s=t.callback(),i=document.querySelector(`.ue-interface #item-${e+1}`);i&&i.innerText!==s&&(i.innerText=s)}))}static statsShift(t){const e=document.querySelector(".top-left");e&&(e.style.top=`${t}px`)}static setUpdateInterval(t){j=t}static get updateInterval(){return j}}function D(){const t=new g,e=document.createElement("div");return e.classList.toggle("stats"),t.showPanel(0),e.appendChild(t.dom),document.body.appendChild(e),B.statsShift(48),t}class O{constructor(t,e=60){if(this.requestId=0,this.animate=t,this.fps=e,!window)throw new Error("No window context")}start(){let t=performance.now();const e=1e3/this.fps,s=i=>{this.requestId=window.requestAnimationFrame(s);const n=i-t;n>=e-.1&&(t=i-n%e,this.animate(n))};this.requestId=window.requestAnimationFrame(s)}stop(){window.cancelAnimationFrame(this.requestId)}}let A="normal";class q{constructor(t,e,s=60){this.fps=60,this.name=t,this.env=e,this.tick=0,this.stats=null,this.showStatsPanel=!0,this.gameLoop=null,this.fps=s}static setRendererType(t){A=t}static get rendererType(){return A}toggleStats(t){this.showStatsPanel=void 0!==t?t:!this.showStatsPanel,this.showStatsPanel?this.stats=D():(this.stats=null,document.querySelector(".stats")&&document.querySelector(".stats").remove())}makeAnimationFrame(){this.animationFrame=new O((t=>this.update(t)),this.fps)}setMainLoop(t){this.gameLoop=t,this.makeAnimationFrame()}setFPS(t){this.fps=t,this.makeAnimationFrame()}update(t){var e,s;null==(e=this.stats)||e.begin(),w.tick(),this.gameLoop&&this.gameLoop(t),this.tick%B.updateInterval==0&&B.update(),null==(s=this.stats)||s.end(),this.tick++}start(){if(!this.gameLoop)throw new Error("No game loop");if(!this.animationFrame)throw new Error("AnimationFrame");window.addEventListener("DOMContentLoaded",(()=>{var t;this.name&&(document.title=this.name),w.init(),B.init(),this.showStatsPanel&&(this.stats=D()),null==(t=this.animationFrame)||t.start()}))}}class ${constructor(t,e){this.width=t,this.height=e}update(){}render(){}}class _{constructor(t,e){this.x=t,this.y=e}collide(t){return!!(t.width&&t.height&&this.width&&this.height)&&(this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.height+this.y>t.y)}update(...t){}render(...t){}}class tt extends _{constructor(t,e){super(t,e)}update(...t){}render(...t){}}class et{constructor(t,e){this.delay=t,this.callback=e,window.setTimeout(this.callback,this.delay)}}class st extends _{constructor(t,e,s=5,i,n){super(e.x,e.y),this.id=t,this.pos=e.clone(),this.angle=i&&"random"!=i?i%2*Math.PI:Math.PI/2+2*Math.random()*Math.PI,this.velocity=new d(Math.random()*s*Math.cos(this.angle),Math.random()*s*Math.sin(this.angle)),this.color=n||"red",this.opacity=u(100,255*Math.random(),255),this.radius=2}update(){this.velocity.y+=.01,this.pos=this.pos.add(this.velocity),this.opacity--}render(){switch(q.rendererType){case"normal":H.circle(this.pos.x,this.pos.y,this.radius,{fillStyle:this.color,lineWidth:1,globalAlpha:this.opacity/255});break;case"offscreen":M.circle(this.pos.x,this.pos.y,this.radius,{fillStyle:this.color,lineWidth:1,globalAlpha:this.opacity/255})}}}class it{constructor(t,e,s,i){this.pos=e,this.lifeDuration=s,this.particles=[],this.UUID=100*r.randint(1,100);for(let n=0;n<t;n++){let t=new st(this.UUID+n,this.pos);this.particles.push(t)}new et(this.lifeDuration,(()=>{this.destroy(),i&&i()}))}addParticles(t){return t.concat(this.particles)}removeParticles(t){const e=this.particles.length;return t.filter((t=>!y(t.id,this.UUID,this.UUID+e)))}destroy(){}}var nt,lt;(lt=nt||(nt={}))[lt.Turret=0]="Turret",lt[lt.Road=1]="Road",lt[lt.Ground=2]="Ground",lt[lt.Empty=3]="Empty";class at{constructor(t,e){this.rows=e,this.cols=t,this.cells=[],this.focusCell=null,this.createCells(),this.defineNeighboors()}createCells(){for(let t=0;t<this.cols;t++)for(let e=0;e<this.rows;e++)this.cells.push(new ot(t,e))}updateCell(t){if(this.cells.includes(t)){if(1!==t.width||1!==t.height){if(t.width>1){let e=t.width-1,s=this.cells.filter((s=>s.y===t.y&&s.x>t.x&&s.x<=t.x+e));this.cells=this.cells.filter((t=>!s.includes(t)))}if(t.height>1){let e=t.height-1,s=this.cells.filter((s=>s.x===t.x&&s.y>t.y&&s.y<=t.y+e));this.cells=this.cells.filter((t=>!s.includes(t)))}}this.defineNeighboors(),this.cells[this.cells.indexOf(t)]=t}}defineNeighboors(){this.cells.forEach((t=>{t.neighboor.top=t.y>=1?this.cells.filter((e=>e.x<=t.x&&e.x+e.width>t.x&&e.y===t.y-t.height))[0]:null,t.neighboor.bottom=t.y<=this.rows-1?this.cells.filter((e=>e.x<=t.x&&e.x+e.width>t.x&&e.y===t.y+t.height))[0]:null,t.neighboor.left=t.x>=1?this.cells.filter((e=>e.y<=t.y&&e.y+e.height>t.y&&e.x===t.x-t.width))[0]:null,t.neighboor.right=t.x<=this.cols-1?this.cells.filter((e=>e.y<=t.y&&e.y+e.height>t.y&&e.x===t.x+t.width))[0]:null}))}}class ot{constructor(t,e,s=1,i=1){this.x=t,this.y=e,this.width=s,this.height=i,this.highlight=!1,this.type=2,this.neighboor={}}toggleHighlight(){this.highlight=!this.highlight}}const ct={},rt="0.3.8";export{ot as Cell,ct as Config,et as Cooldown,Z as Event,q as Game,$ as GameEnvironement,_ as GameObject,at as Grid,B as Interface,M as OffscreenRenderer,st as Particle,it as ParticuleGenerator,tt as PlayerObject,h as Point,r as Random,H as Renderer,U as Texture,rt as VERSION,m as V_NULL,p as V_UNIT,d as Vector2,u as clamp,W as createCanvas,C as getWindowDimensions,y as inRange};
