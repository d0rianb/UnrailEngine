var t=Object.defineProperty,e=Object.defineProperties,s=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=(e,s,i)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i,o=(t,e)=>{for(var s in e||(e={}))n.call(e,s)&&l(t,s,e[s]);if(i)for(var s of i(e))a.call(e,s)&&l(t,s,e[s]);return t},c=(t,i)=>e(t,s(i));"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;class d{static random(){return Math.random()}static randint(t,e){return Math.floor(t+Math.random()*(e-t))}static choice(t){return t[~~(d.random()*t.length)]}static bool(){return d.random()>.5}static sign(){return d.choice([-1,1])}static percent(t){return d.random()<t/100}}var r=d;class h{constructor(t,e){this.x=t,this.y=e}clone(){return new h(this.x,this.y)}add(t){return new h(this.x+t.x,this.y+t.y)}multiply(t){return new h(this.x*t,this.y*t)}dot(t){return this.x*t.x+this.y*t.y}dist(t){return Math.sqrt((this.x-t.x)**2+(this.y-t.y)**2)}}const u=h,m=new h(0,0),p=new h(1,1);function y(t,e,s){return t>s?y(s,e,t):Math.max(t,Math.min(e,s))}function b(t,e,s){return y(e,t,s)===t}function Z(){return{width:window.innerWidth,height:window.innerHeight}}function x(t){return{width:t.clientWidth||t.width,height:t.clientHeight||t.height}}function G(t,e,s,i){t.width=e*(i||window.devicePixelRatio||1),t.height=s*(i||window.devicePixelRatio||1),t.style.width=e+"px",t.style.height=s+"px"}function f(t,e,s,i){const n=document.createElement("canvas");return g(n,t,e,s),i&&(n.oncontextmenu=t=>t.preventDefault()),n}function g(t,e,s,i){const n=i||window.devicePixelRatio||1;G(t,e||x(t).width,s||x(t).height,n),1!=n&&t.getContext("2d").setTransform(n,0,0,n,0,0)}function w(t,e){window.addEventListener("DOMContentLoaded",(()=>{var s;const i=null!=(s=document.querySelector(e))?s:document.createElement(e);i.appendChild(t),document.querySelector("body").appendChild(i)}))}function W(t,e,s=300){var i;null==(i=document.querySelector(t))||i.classList.toggle(e),setTimeout((()=>{var s;return null==(s=document.querySelector(t))?void 0:s.classList.toggle(e)}),s)}function C(){return null==self.document&&null==self.window}function L(t){let e="";for(const s in t)e+=`#${s}:${t[s]}`;return e}function v(){return performance.now()||Date.now()}function X(t){return window&&t in window}function S(){return/complete|interactive|loaded/.test(document.readyState)}var R,k;(k=R||(R={}))[k.KeyboardPressed=0]="KeyboardPressed",k[k.KeyboardDown=1]="KeyboardDown",k[k.Mouse=2]="Mouse",k[k.Window=3]="Window",k[k.Custom=4]="Custom",k[k.All=5]="All";class K{constructor(t,e,s=4){this.name=t,this.callback=e,this.type=s,this.listeners=[this.callback]}static emit(t,e){t instanceof Array?t.forEach((t=>this.emitEvent(t,e))):this.emitEvent(t,e)}static emitEvent(t,e){const s=V.getCustomEvent(t);s&&s.listeners.forEach((t=>t(e)))}static on(t,e){t instanceof Array?t.forEach((t=>this.onEvent(t,e))):this.onEvent(t,e)}static onEvent(t,e){const s=V.getCustomEvent(t);if(s)s.listeners.push(e);else{const s=new K(t,e,4);V.addEvent(s)}}static onKeyDown(t,e){t instanceof Array?t.forEach((t=>V.addEvent(new K(t,e,1)))):V.addEvent(new K(t,e,1))}static onKeyPressed(t,e){t instanceof Array?t.forEach((t=>V.addEvent(new K(t,e,0)))):V.addEvent(new K(t,e,0))}static onAnyKeyReleased(t){V.addEvent(new K("keyup",t,3))}static onClick(t){K.onMouseClick(t)}static onMouseClick(t){V.addEvent(new K("click",t,2))}static onMouseMove(t){V.addEvent(new K("mousemove",t,2))}}const V=new class{constructor(){this.windowEvents=[],this.customEvents=[],this.mouseEvents=[],this.keyboardEvents=[],this.currentKeyEvents=[]}init(){window.addEventListener("keydown",(t=>{this.currentKeyEvents.find((e=>e.code===t.code))||this.currentKeyEvents.push(t),this.keyboardEvents.filter((t=>t.type===R.KeyboardPressed)).forEach((e=>{t.code===e.name&&e.callback(t)}))})),window.addEventListener("keyup",(t=>{this.currentKeyEvents.length&&(this.currentKeyEvents=this.currentKeyEvents.filter((e=>e.code!==t.code)))})),this.bindEvents()}addEvent(t){switch(t.type){case R.KeyboardDown:case R.KeyboardPressed:this.keyboardEvents.push(t);break;case R.Mouse:this.mouseEvents.push(t),window.addEventListener(t.name,(e=>t.callback(e)));break;case R.Window:this.windowEvents.push(t),this.bindEvents();break;case R.Custom:this.customEvents.push(t)}}getCustomEvent(t){return this.customEvents.find((e=>e.name===t))}bindEvents(){this.windowEvents.forEach((t=>window.addEventListener(t.name,t.callback)))}tick(){this.currentKeyEvents.length&&this.keyboardEvents.filter((t=>t.type===R.KeyboardDown)).forEach((t=>{this.currentKeyEvents.forEach((e=>{e.code===t.name&&t.callback(e)}))}))}};const Y=new class{constructor(){this.hasStarted=!1,this.animations=[]}add(t){this.animations.push(t),this.hasStarted&&t.options.autostart&&t.start()}init(){this.hasStarted=!0;for(let t of this.animations)t.options.autostart&&t.start()}tick(t){for(let e of this.animations)e.update(t)}};var H,I={exports:{}},N=I.exports=((H=function(){function t(t){return i.appendChild(t.dom),t}function e(t){for(var e=0;e<i.children.length;e++)i.children[e].style.display=e===t?"block":"none";s=t}var s=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",(function(t){t.preventDefault(),e(++s%i.children.length)}),!1);var n=(performance||Date).now(),a=n,l=0,o=t(new H.Panel("FPS","#0ff","#002")),c=t(new H.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var d=t(new H.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:i,addPanel:t,showPanel:e,begin:function(){n=(performance||Date).now()},end:function(){l++;var t=(performance||Date).now();if(c.update(t-n,200),t>a+1e3&&(o.update(1e3*l/(t-a),100),a=t,l=0,d)){var e=performance.memory;d.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){n=this.end()},domElement:i,setMode:e}}).Panel=function(t,e,s){var i=1/0,n=0,a=Math.round,l=a(window.devicePixelRatio||1),o=80*l,c=48*l,d=3*l,r=2*l,h=3*l,u=15*l,m=74*l,p=30*l,y=document.createElement("canvas");y.width=o,y.height=c,y.style.cssText="width:80px;height:48px";var b=y.getContext("2d");return b.font="bold "+9*l+"px Helvetica,Arial,sans-serif",b.textBaseline="top",b.fillStyle=s,b.fillRect(0,0,o,c),b.fillStyle=e,b.fillText(t,d,r),b.fillRect(h,u,m,p),b.fillStyle=s,b.globalAlpha=.9,b.fillRect(h,u,m,p),{dom:y,update:function(c,Z){i=Math.min(i,c),n=Math.max(n,c),b.fillStyle=s,b.globalAlpha=1,b.fillRect(0,0,o,u),b.fillStyle=e,b.fillText(a(c)+" "+t+" ("+a(i)+"-"+a(n)+")",d,r),b.drawImage(y,h+l,u,m-l,p,h,u,m-l,p),b.fillRect(h+m-l,u,l,p),b.fillStyle=s,b.globalAlpha=.9,b.fillRect(h+m-l,u,l,a((1-c/Z)*p))}}},H);String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};class Q extends Error{constructor(t,e){super(e?`[${e.capitalize()}] - ${t}`:t),this.name="EngineFailure"}}class M extends Q{constructor(t){super(t,"renderer")}}const U={strokeStyle:"black",lineWidth:2,lineJoin:"round",lineCap:"round",fillStyle:"transparent",globalAlpha:1,globalCompositeOperation:"add"},F={font:"Roboto",size:16,color:"black",textAlign:"left",textBaseline:"alphabetic"},E=2*Math.PI;let z,J,T,j,P,O=C()?4:2*(window.devicePixelRatio||1),B=m;function D(t){return~~(t*O)/O}class A{static create(t,e){let[s,i]=[Z().width,Z().height];const n=f(t||s,e||i);return w(n,"main"),A.setContext(n.getContext("2d")),n}static createFromCanvas(t){let e=document.querySelector(t);if(!(e&&e instanceof HTMLCanvasElement))throw new M("The selected element is not a canvas");return g(e),A.setContext(e.getContext("2d")),e}static setContext(t){z=t}static getContext(){return z}static setOffset(t,e){B=new h(t,e)}static getOffset(){return B}static style(t){if(!z)throw new M("Context has not been initialize. Please use Renderer.setContext");const e=o(o({},U),t);if(e!==J){for(let t in e)z[t]!==e[t]&&(z[t]=e[t]);J=e}}static textStyle(t){if(z){let e=o(o({},F),t);z.font=`${e.size}px ${e.font}`,delete e.size,delete e.font,A.style(o({fillStyle:e.color},e))}}static clear(t){t?(A.style({fillStyle:t}),z.fillRect(0,0,z.canvas.width,z.canvas.height)):z.clearRect(0,0,z.canvas.width,z.canvas.height)}static line(t,e,s,i,n){A.style(n),z.beginPath(),z.moveTo(D(B.x+t),D(B.y+e)),z.lineTo(D(B.x+s),D(B.y+i)),z.stroke()}static rect(t,e,s,i,n){A.style(n);const[a,l,o,c]=[D(t+B.x),D(e+B.y),D(s),D(i)];z.fillRect(a,l,o,c),z.strokeRect(a,l,o,c)}static rectFromCenter(t,e,s,i,n){return A.rect(t-s/2,e-i/2,s,i,n)}static rectFromPoints(t,e,s,i,n){return A.rect(t,e,s-t,i-e,n)}static poly(t,e){if(t.length){A.style(e),z.beginPath(),z.moveTo(D(t[0].x+B.x),D(t[0].y+B.y));for(let e=1;e<t.length;e++)z.lineTo(D(t[e].x+B.x),D(t[e].y+B.y));z.stroke()}}static circle(t,e,s,i){A.style(i),z.beginPath(),z.arc(D(t+B.x),D(e+B.y),s,0,E),z.fill(),z.stroke()}static circleFromRect(t,e,s,i,n){return A.circle(t+s/2,e+i/2,Math.min(s,i)/2,n)}static point(t,e,s){A.circle(t,e,5,s)}static rectSprite(t,e,s,i,n){n.isLoaded&&(A.style({}),z.save(),z.translate(D(t+s/2+B.x),D(e+i/2+B.y)),z.scale(n.scale.x,n.scale.y),z.rotate(n.rotation),z.drawImage(n.image,D(s*n.offset.x-s/2),D(i*n.offset.y-i/2),D(s),D(i)),z.restore())}static circleSprite(t,e,s,i){i.isLoaded&&(z.save(),z.beginPath(),z.arc(D(t+B.x),D(e+B.y),s,0,E),z.clip(),A.rectSprite(t-s,e-s,2*s,2*s,i),z.restore())}static text(t,e,s,i){A.textStyle(i),z.fillText(t,e,s)}static centeredText(t,e,s,i){A.text(t,e,s,c(o({},i),{textAlign:"center",textBaseline:"middle"}))}static tint(t,e,s,i,n){A.rect(e,s,i,n,{fillStyle:t,globalCompositeOperation:"multiply",globalAlpha:.25})}static beginFrame(t){A.clear(t)}static endFrame(){}}class q{constructor(t,e){this.title=t,this.content=e}}class ${constructor(t,e){this.methodName=t,this.args=e}}function _(){return new Worker("data:application/javascript;base64,dmFyIGU9T2JqZWN0LmRlZmluZVByb3BlcnR5LHQ9T2JqZWN0LmRlZmluZVByb3BlcnRpZXMsaT1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyxzPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMscj1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LG49T2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZSxhPSh0LGkscyk9PmkgaW4gdD9lKHQsaSx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITAsdmFsdWU6c30pOnRbaV09cyxjPShlLHQpPT57Zm9yKHZhciBpIGluIHR8fCh0PXt9KSlyLmNhbGwodCxpKSYmYShlLGksdFtpXSk7aWYocylmb3IodmFyIGkgb2Ygcyh0KSluLmNhbGwodCxpKSYmYShlLGksdFtpXSk7cmV0dXJuIGV9LG89KGUscyk9PnQoZSxpKHMpKTtmdW5jdGlvbiBsKCl7cmV0dXJue3dpZHRoOndpbmRvdy5pbm5lcldpZHRoLGhlaWdodDp3aW5kb3cuaW5uZXJIZWlnaHR9fWZ1bmN0aW9uIGgoZSl7cmV0dXJue3dpZHRoOmUuY2xpZW50V2lkdGh8fGUud2lkdGgsaGVpZ2h0OmUuY2xpZW50SGVpZ2h0fHxlLmhlaWdodH19ZnVuY3Rpb24gZChlLHQsaSxzKXtjb25zdCByPXN8fHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvfHwxOyFmdW5jdGlvbihlLHQsaSxzKXtlLndpZHRoPXQqKHN8fHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvfHwxKSxlLmhlaWdodD1pKihzfHx3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpb3x8MSksZS5zdHlsZS53aWR0aD10KyJweCIsZS5zdHlsZS5oZWlnaHQ9aSsicHgifShlLHR8fGgoZSkud2lkdGgsaXx8aChlKS5oZWlnaHQsciksMSE9ciYmZS5nZXRDb250ZXh0KCIyZCIpLnNldFRyYW5zZm9ybShyLDAsMCxyLDAsMCl9Y2xhc3MgeHtjb25zdHJ1Y3RvcihlLHQpe3RoaXMueD1lLHRoaXMueT10fWNsb25lKCl7cmV0dXJuIG5ldyB4KHRoaXMueCx0aGlzLnkpfWFkZChlKXtyZXR1cm4gbmV3IHgodGhpcy54K2UueCx0aGlzLnkrZS55KX1tdWx0aXBseShlKXtyZXR1cm4gbmV3IHgodGhpcy54KmUsdGhpcy55KmUpfWRvdChlKXtyZXR1cm4gdGhpcy54KmUueCt0aGlzLnkqZS55fWRpc3QoZSl7cmV0dXJuIE1hdGguc3FydCgodGhpcy54LWUueCkqKjIrKHRoaXMueS1lLnkpKioyKX19Y29uc3QgdT1uZXcgeCgwLDApO1N0cmluZy5wcm90b3R5cGUuY2FwaXRhbGl6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK3RoaXMuc2xpY2UoMSl9O2NsYXNzIHkgZXh0ZW5kcyBFcnJvcntjb25zdHJ1Y3RvcihlLHQpe3N1cGVyKHQ/YFske3QuY2FwaXRhbGl6ZSgpfV0gLSAke2V9YDplKSx0aGlzLm5hbWU9IkVuZ2luZUZhaWx1cmUifX1jbGFzcyBmIGV4dGVuZHMgeXtjb25zdHJ1Y3RvcihlKXtzdXBlcihlLCJyZW5kZXJlciIpfX1jb25zdCBnPXtzdHJva2VTdHlsZToiYmxhY2siLGxpbmVXaWR0aDoyLGxpbmVKb2luOiJyb3VuZCIsbGluZUNhcDoicm91bmQiLGZpbGxTdHlsZToidHJhbnNwYXJlbnQiLGdsb2JhbEFscGhhOjEsZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uOiJhZGQifSxwPXtmb250OiJSb2JvdG8iLHNpemU6MTYsY29sb3I6ImJsYWNrIix0ZXh0QWxpZ246ImxlZnQiLHRleHRCYXNlbGluZToiYWxwaGFiZXRpYyJ9LHc9MipNYXRoLlBJO2xldCBiLG0sdj1udWxsPT1zZWxmLmRvY3VtZW50JiZudWxsPT1zZWxmLndpbmRvdz80OjIqKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvfHwxKSxDPXU7ZnVuY3Rpb24gayhlKXtyZXR1cm5+fihlKnYpL3Z9Y2xhc3MgVHtzdGF0aWMgY3JlYXRlKGUsdCl7bGV0W2ksc109W2woKS53aWR0aCxsKCkuaGVpZ2h0XTtjb25zdCByPWZ1bmN0aW9uKGUsdCxpLHMpe2NvbnN0IHI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7cmV0dXJuIGQocixlLHQsaSkscyYmKHIub25jb250ZXh0bWVudT1lPT5lLnByZXZlbnREZWZhdWx0KCkpLHJ9KGV8fGksdHx8cyk7cmV0dXJuIGZ1bmN0aW9uKGUsdCl7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCgoKT0+e3ZhciBpO2NvbnN0IHM9bnVsbCE9KGk9ZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0KSk/aTpkb2N1bWVudC5jcmVhdGVFbGVtZW50KHQpO3MuYXBwZW5kQ2hpbGQoZSksZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiYm9keSIpLmFwcGVuZENoaWxkKHMpfSkpfShyLCJtYWluIiksVC5zZXRDb250ZXh0KHIuZ2V0Q29udGV4dCgiMmQiKSkscn1zdGF0aWMgY3JlYXRlRnJvbUNhbnZhcyhlKXtsZXQgdD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGUpO2lmKCEodCYmdCBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50KSl0aHJvdyBuZXcgZigiVGhlIHNlbGVjdGVkIGVsZW1lbnQgaXMgbm90IGEgY2FudmFzIik7cmV0dXJuIGQodCksVC5zZXRDb250ZXh0KHQuZ2V0Q29udGV4dCgiMmQiKSksdH1zdGF0aWMgc2V0Q29udGV4dChlKXtiPWV9c3RhdGljIGdldENvbnRleHQoKXtyZXR1cm4gYn1zdGF0aWMgc2V0T2Zmc2V0KGUsdCl7Qz1uZXcgeChlLHQpfXN0YXRpYyBnZXRPZmZzZXQoKXtyZXR1cm4gQ31zdGF0aWMgc3R5bGUoZSl7aWYoIWIpdGhyb3cgbmV3IGYoIkNvbnRleHQgaGFzIG5vdCBiZWVuIGluaXRpYWxpemUuIFBsZWFzZSB1c2UgUmVuZGVyZXIuc2V0Q29udGV4dCIpO2NvbnN0IHQ9YyhjKHt9LGcpLGUpO2lmKHQhPT1tKXtmb3IobGV0IGUgaW4gdCliW2VdIT09dFtlXSYmKGJbZV09dFtlXSk7bT10fX1zdGF0aWMgdGV4dFN0eWxlKGUpe2lmKGIpe2xldCB0PWMoYyh7fSxwKSxlKTtiLmZvbnQ9YCR7dC5zaXplfXB4ICR7dC5mb250fWAsZGVsZXRlIHQuc2l6ZSxkZWxldGUgdC5mb250LFQuc3R5bGUoYyh7ZmlsbFN0eWxlOnQuY29sb3J9LHQpKX19c3RhdGljIGNsZWFyKGUpe2U/KFQuc3R5bGUoe2ZpbGxTdHlsZTplfSksYi5maWxsUmVjdCgwLDAsYi5jYW52YXMud2lkdGgsYi5jYW52YXMuaGVpZ2h0KSk6Yi5jbGVhclJlY3QoMCwwLGIuY2FudmFzLndpZHRoLGIuY2FudmFzLmhlaWdodCl9c3RhdGljIGxpbmUoZSx0LGkscyxyKXtULnN0eWxlKHIpLGIuYmVnaW5QYXRoKCksYi5tb3ZlVG8oayhDLngrZSksayhDLnkrdCkpLGIubGluZVRvKGsoQy54K2kpLGsoQy55K3MpKSxiLnN0cm9rZSgpfXN0YXRpYyByZWN0KGUsdCxpLHMscil7VC5zdHlsZShyKTtjb25zdFtuLGEsYyxvXT1bayhlK0MueCksayh0K0MueSksayhpKSxrKHMpXTtiLmZpbGxSZWN0KG4sYSxjLG8pLGIuc3Ryb2tlUmVjdChuLGEsYyxvKX1zdGF0aWMgcmVjdEZyb21DZW50ZXIoZSx0LGkscyxyKXtyZXR1cm4gVC5yZWN0KGUtaS8yLHQtcy8yLGkscyxyKX1zdGF0aWMgcmVjdEZyb21Qb2ludHMoZSx0LGkscyxyKXtyZXR1cm4gVC5yZWN0KGUsdCxpLWUscy10LHIpfXN0YXRpYyBwb2x5KGUsdCl7aWYoZS5sZW5ndGgpe1Quc3R5bGUodCksYi5iZWdpblBhdGgoKSxiLm1vdmVUbyhrKGVbMF0ueCtDLngpLGsoZVswXS55K0MueSkpO2ZvcihsZXQgdD0xO3Q8ZS5sZW5ndGg7dCsrKWIubGluZVRvKGsoZVt0XS54K0MueCksayhlW3RdLnkrQy55KSk7Yi5zdHJva2UoKX19c3RhdGljIGNpcmNsZShlLHQsaSxzKXtULnN0eWxlKHMpLGIuYmVnaW5QYXRoKCksYi5hcmMoayhlK0MueCksayh0K0MueSksaSwwLHcpLGIuZmlsbCgpLGIuc3Ryb2tlKCl9c3RhdGljIGNpcmNsZUZyb21SZWN0KGUsdCxpLHMscil7cmV0dXJuIFQuY2lyY2xlKGUraS8yLHQrcy8yLE1hdGgubWluKGkscykvMixyKX1zdGF0aWMgcG9pbnQoZSx0LGkpe1QuY2lyY2xlKGUsdCw1LGkpfXN0YXRpYyByZWN0U3ByaXRlKGUsdCxpLHMscil7ci5pc0xvYWRlZCYmKFQuc3R5bGUoe30pLGIuc2F2ZSgpLGIudHJhbnNsYXRlKGsoZStpLzIrQy54KSxrKHQrcy8yK0MueSkpLGIuc2NhbGUoci5zY2FsZS54LHIuc2NhbGUueSksYi5yb3RhdGUoci5yb3RhdGlvbiksYi5kcmF3SW1hZ2Uoci5pbWFnZSxrKGkqci5vZmZzZXQueC1pLzIpLGsocypyLm9mZnNldC55LXMvMiksayhpKSxrKHMpKSxiLnJlc3RvcmUoKSl9c3RhdGljIGNpcmNsZVNwcml0ZShlLHQsaSxzKXtzLmlzTG9hZGVkJiYoYi5zYXZlKCksYi5iZWdpblBhdGgoKSxiLmFyYyhrKGUrQy54KSxrKHQrQy55KSxpLDAsdyksYi5jbGlwKCksVC5yZWN0U3ByaXRlKGUtaSx0LWksMippLDIqaSxzKSxiLnJlc3RvcmUoKSl9c3RhdGljIHRleHQoZSx0LGkscyl7VC50ZXh0U3R5bGUocyksYi5maWxsVGV4dChlLHQsaSl9c3RhdGljIGNlbnRlcmVkVGV4dChlLHQsaSxzKXtULnRleHQoZSx0LGksbyhjKHt9LHMpLHt0ZXh0QWxpZ246ImNlbnRlciIsdGV4dEJhc2VsaW5lOiJtaWRkbGUifSkpfXN0YXRpYyB0aW50KGUsdCxpLHMscil7VC5yZWN0KHQsaSxzLHIse2ZpbGxTdHlsZTplLGdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbjoibXVsdGlwbHkiLGdsb2JhbEFscGhhOi4yNX0pfXN0YXRpYyBiZWdpbkZyYW1lKGUpe1QuY2xlYXIoZSl9c3RhdGljIGVuZEZyYW1lKCl7fX1uZXcgY2xhc3MgZXh0ZW5kcyBjbGFzc3tzZW5kTWVzc2FnZVRvTWFpblRocmVhZChlLHQpe3NlbGYucG9zdE1lc3NhZ2Uoe3RpdGxlOmUsZGF0YTp0fSl9bG9nKC4uLmUpe3RoaXMuc2VuZE1lc3NhZ2VUb01haW5UaHJlYWQoImxvZyIsLi4uZSl9fXtjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5jYW52YXNSZXNvbHV0aW9uPTEsdGhpcy5vZmZzY3JlZW5DYW52YXM9bnVsbCx0aGlzLmN0eD1udWxsLHRoaXMudGV4dHVyZUFsaWFzPW5ldyBNYXAsc2VsZi5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwoKHtkYXRhOmV9KT0+dGhpcy5vbk1lc3NhZ2UoZS50aXRsZSxlLmNvbnRlbnQpKSl9b25NZXNzYWdlKGUsdCl7c3dpdGNoKGUpe2Nhc2UiaW5pdENhbnZhcyI6dGhpcy5vZmZzY3JlZW5DYW52YXM9dC5jYW52YXMsdGhpcy5jdHg9dGhpcy5vZmZzY3JlZW5DYW52YXMuZ2V0Q29udGV4dCgiMmQiKSxULnNldENvbnRleHQodGhpcy5jdHgpLHRoaXMuc2V0U2l6ZSh0LmRwcix0LndpZHRoLHQuaGVpZ2h0KSx0aGlzLnNlbmRNZXNzYWdlVG9NYWluVGhyZWFkKCJpbml0aWFsaXplZCIpO2JyZWFrO2Nhc2UicmVuZGVyIjpmb3IobGV0IGUgb2YgdC5yZW5kZXJTdGFjayl0aGlzLmhhbmRsZURyYXdSZXF1ZXN0KGUubWV0aG9kTmFtZSxlLmFyZ3MpO2JyZWFrO2Nhc2UibmV3VGV4dHVyZSI6dGhpcy50ZXh0dXJlQWxpYXMuc2V0KHQuaWQsdC50ZXh0dXJlKX19c2V0U2l6ZShlLHQsaSl7Y29uc3Qgcz0oZXx8MSkqdGhpcy5jYW52YXNSZXNvbHV0aW9uO3RoaXMub2Zmc2NyZWVuQ2FudmFzLndpZHRoPXQqcyx0aGlzLm9mZnNjcmVlbkNhbnZhcy5oZWlnaHQ9aSpzLCJzZXRUcmFuc2Zvcm0iaW4gdGhpcy5jdHgmJnRoaXMuY3R4LnNldFRyYW5zZm9ybShzLDAsMCxzLDAsMCl9Z2V0VGV4dHVyZShlKXtjb25zdCB0PXRoaXMudGV4dHVyZUFsaWFzLmdldChlLnRleHR1cmVJZCkse3NjYWxlOmkscm90YXRpb246cyxvZmZzZXQ6cn09ZTtyZXR1cm4gbyhjKHt9LHQpLHtzY2FsZTppLHJvdGF0aW9uOnMsb2Zmc2V0OnJ9KX1oYW5kbGVEcmF3UmVxdWVzdChlLHQpe3N3aXRjaChlKXtjYXNlInN0eWxlIjpULnN0eWxlKG51bGw9PXQ/dm9pZCAwOnQub2JqKTticmVhaztjYXNlImNsZWFyIjpULmNsZWFyKG51bGw9PXQ/dm9pZCAwOnQuY29sb3IpO2JyZWFrO2Nhc2UibGluZSI6VC5saW5lKHQueDEsdC55MSx0LngyLHQueTIsdC5vYmopO2JyZWFrO2Nhc2UicmVjdCI6VC5yZWN0KHQueCx0LnksdC53aWR0aCx0LmhlaWdodCx0Lm9iaik7YnJlYWs7Y2FzZSJyZWN0RnJvbUNlbnRlciI6VC5yZWN0RnJvbUNlbnRlcih0LngsdC55LHQud2lkdGgsdC5oZWlnaHQsdC5vYmopO2JyZWFrO2Nhc2UicmVjdEZyb21Qb2ludHMiOlQucmVjdEZyb21Qb2ludHModC54MSx0LnkxLHQueDIsdC55Mix0Lm9iaik7YnJlYWs7Y2FzZSJwb2x5IjpULnBvbHkodC5wb2ludHMsdC5vYmopO2JyZWFrO2Nhc2UiY2lyY2xlIjpULmNpcmNsZSh0LngsdC55LHQucmFkaXVzLHQub2JqKTticmVhaztjYXNlImNpcmNsZUZyb21SZWN0IjpULmNpcmNsZUZyb21SZWN0KHQueCx0LnksdC53aWR0aCx0LmhlaWdodCx0Lm9iaik7YnJlYWs7Y2FzZSJwb2ludCI6VC5wb2ludCh0LngsdC55LHQub2JqKTticmVhaztjYXNlInJlY3RTcHJpdGUiOlQucmVjdFNwcml0ZSh0LngsdC55LHQud2lkdGgsdC5oZWlnaHQsdGhpcy5nZXRUZXh0dXJlKHQpKTticmVhaztjYXNlImNpcmNsZVNwcml0ZSI6VC5jaXJjbGVTcHJpdGUodC54LHQueSx0LnJhZGl1cyx0aGlzLmdldFRleHR1cmUodCkpO2JyZWFrO2Nhc2UidGV4dCI6VC50ZXh0KHQudGV4dCx0LngsdC55LG51bGw9PXQ/dm9pZCAwOnQuc3R5bGUpO2JyZWFrO2Nhc2UiY2VudGVyZWRUZXh0IjpULmNlbnRlcmVkVGV4dCh0LnRleHQsdC54LHQueSxudWxsPT10P3ZvaWQgMDp0LnN0eWxlKTticmVhaztjYXNlInRpbnQiOlQudGludCh0LmNvbG9yLHQueCx0LnksdC53aWR0aCx0LmhlaWdodCl9fX07Cg==",{type:"module"})}let tt=!1,et=[];const st=new Map;class it{static get worker(){return j}static get workerIsInitialized(){return tt}static get offscreenCanvas(){return T}static get renderStack(){return et}static create(t,e){let[s,i]=[Z().width,Z().height];return P=f(t||s,e||i,1),it.initRenderWorker(P,t||s,e||i),w(P,"main"),P}static createFromCanvas(t){if(P=document.querySelector(t),!(P&&P instanceof HTMLCanvasElement))throw new M("The selected element is not a canvas");return g(P,P.clientWidth,P.clientHeight,1),it.initRenderWorker(P,P.width,P.height),P}static initRenderWorker(t,e,s){pt.renderer instanceof it||pt.setRendererType("offscreen");let{clientWidth:i,clientHeight:n}=t;j=new _,T=t.transferControlToOffscreen(),this.sendMessageToWorker("initCanvas",{width:e||i,height:s||n,canvas:T,dpr:window.devicePixelRatio||1},[T]),j.onmessage=({data:{title:t,data:e}})=>{switch(t){case"log":console.log("message from the renderer worker : ",e);break;case"initialized":tt=!0,this.endFrame();break;default:console.log(t)}}}static addRenderCall(t,e){et.push(new $(t,e||{}))}static sendMessageToWorker(t,e,s){return j.postMessage(new q(t,e),s||[])}static style(t){this.addRenderCall("style",{obj:t})}static clear(t){this.addRenderCall("clear",{color:t})}static line(t,e,s,i,n){this.addRenderCall("line",{x1:t,y1:e,x2:s,y2:i,obj:n})}static rect(t,e,s,i,n){this.addRenderCall("rect",{x:t,y:e,width:s,height:i,obj:n})}static rectFromCenter(t,e,s,i,n){this.addRenderCall("rectFromCenter",{x:t,y:e,width:s,height:i,obj:n})}static rectFromPoints(t,e,s,i,n){this.addRenderCall("rectFromPoints",{x1:t,y1:e,x2:s,y2:i,obj:n})}static poly(t,e){this.addRenderCall("poly",{points:t,obj:e})}static circle(t,e,s,i){this.addRenderCall("circle",{x:t,y:e,radius:s,obj:i})}static circleFromRect(t,e,s,i,n){this.addRenderCall("circleFromRect",{x:t,y:e,width:s,height:i,obj:n})}static point(t,e,s){this.addRenderCall("point",{x:t,y:e,obj:s})}static handleTexture(t,e,s){var i;if(t.isLoaded)if(st.has(t.id)){const{scale:i,rotation:n,offset:a}=t;this.addRenderCall(e,c(o({},s),{textureId:t.id,scale:i,rotation:n,offset:a}))}else null==(i=t.convertToBitmap())||i.then((e=>{st.set(t.id,e),this.sendMessageToWorker("newTexture",{id:t.id,texture:e})}))}static rectSprite(t,e,s,i,n){this.handleTexture(n,"rectSprite",{x:t,y:e,width:s,height:i})}static async circleSprite(t,e,s,i){this.handleTexture(i,"circleSprite",{x:t,y:e,radius:s})}static text(t,e,s,i){this.addRenderCall("text",{text:t,x:e,y:s,style:i})}static centeredText(t,e,s,i){this.addRenderCall("centeredText",{text:t,x:e,y:s,style:i})}static tint(t,e,s,i,n){this.addRenderCall("circle",{color:t,x:e,y:s,width:i,height:n})}static beginFrame(t){et=[],this.clear(t)}static endFrame(){tt&&(this.sendMessageToWorker("render",{renderStack:et}),et=[])}}const nt=X("OffscreenCanvas")?it:A;let at=0;class lt{constructor(t,e){if(this.isLoaded=!1,!t)throw new Error("A source path to the resource must be provided");this.id=at++,this.image=new Image,this.image.src=t,this.image.onload=()=>this.isLoaded=!0,this.size=new h(this.image.width,this.image.height),this.rotation=(null==e?void 0:e.rotation)||0,this.offset=(null==e?void 0:e.offset)||m,this.scale=(null==e?void 0:e.scale)||p}async convertToBitmap(){if(!this.image.width||!this.image.height)return;const t=await createImageBitmap(this.image);return c(o({},this),{image:t})}}let ot=[],ct=4;const dt=["top-left","top-right","bottom-left","bottom-right","custom"];class rt{static addItem(t,e,s){rt.internalAddItem(t,e,s)}static addButton(t,e,s,i){rt.internalAddItem(t,s,i,e)}static internalAddItem(t,e,s,i){const n={callback:"string"==typeof t?()=>t:t,position:e,options:s,onClick:i};ot.push(n);const a=ot.length;S()?rt.addToDom(n,a):window.addEventListener("load",(()=>rt.addToDom(n,a)))}static init(){rt.addStyle('*,\n*::after,\n*::before {\n    box-sizing: border-box;\n}\n\nbody {\n    margin: 0;\n    font-family: "Roboto";\n    font-weight: 400;\n    width: 100vw;\n    height: 100vh;\n    overflow: hidden;\n}\n\ncanvas {\n    z-index: 10;\n    image-rendering: pixelated;\n}\n\n.ue-interface {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    display: flex;\n    padding: 0.5em;\n    z-index: 10;\n    /* Make the click event pass through */\n    pointer-events: none;\n}\n\n.ue-container>div {\n    position: absolute;\n    display: flex;\n    flex-flow: column nowrap;\n}\n\n.ue-container>.top-left {\n    top: 0;\n    left: 0;\n}\n\n.ue-container>.top-right {\n    top: 0;\n    right: 0;\n    text-align: right;\n}\n\n.ue-container>.bottom-left {\n    bottom: 0;\n    left: 0;\n}\n\n.ue-container>.bottom-right {\n    bottom: 0;\n    right: 0;\n    text-align: right;\n}\n\n.ue-interface-items {\n    padding: .1em;\n}\n\n.ue-interface-button {\n    cursor: pointer;\n    user-select: none;\n    pointer-events: all;\n}');const t=document.createElement("div");t.classList.add("ue-interface","ue-container");for(let e of dt){const s=document.createElement("div");s.classList.add(e),t.appendChild(s)}document.body.appendChild(t)}static addStyle(t){const e=document.createElement("style");e.textContent=t,document.head.append(e)}static addToDom(t,e){var s,i;const n=t.callback(),a=document.createElement("span");a.classList.add("ue-interface-items"),a.id=`item-${e}`,a.innerText=n,Object.entries(t.options||{}).forEach((([t,e])=>a.style[t]=e)),t.position?null==(s=document.querySelector(`.ue-container > .${t.position}`))||s.appendChild(a):null==(i=document.querySelector(".ue-container > .custom"))||i.appendChild(a),t.onClick&&(a.addEventListener("click",(e=>t.onClick(e))),a.classList.add("ue-interface-button"))}static update(){ot.forEach(((t,e)=>{const s=t.callback(),i=document.querySelector(`.ue-interface #item-${e+1}`);i&&i.innerText!==s&&(i.innerText=s)}))}static statsShift(t){const e=document.querySelector(".top-left");e&&(e.style.top=`${t}px`)}static setUpdateInterval(t){ct=t}static get updateInterval(){return ct}static getItems(){return ot}}function ht(){const t=new N,e=document.createElement("div");return e.classList.toggle("stats"),t.showPanel(0),e.appendChild(t.dom),document.body.appendChild(e),rt.statsShift(48),t}class ut{constructor(t,e=60){if(this.requestId=0,this.animate=t,this.fps=e,!window)throw new Q("No window context","core")}start(){let t=v();const e=1e3/this.fps,s=i=>{this.requestId=window.requestAnimationFrame(s);const n=i-t;n>=e-.1&&(t=i-n%e,this.animate(n))};this.requestId=window.requestAnimationFrame(s)}stop(){window.cancelAnimationFrame(this.requestId)}}let mt="normal";class pt{constructor(t,e,s=60){this.fps=60,this.name=t,this.env=e,this.tick=0,this.stats=null,this.showStatsPanel=!0,this.gameLoop=this.env?()=>e.update():null,this.fps=s,this.makeAnimationFrame()}static setRendererType(t){mt=t}static get renderer(){return"normal"===mt?A:nt}toggleStats(t){this.showStatsPanel=void 0!==t?t:!this.showStatsPanel,this.showStatsPanel?this.stats=ht():(this.stats=null,document.querySelector(".stats")&&document.querySelector(".stats").remove())}makeAnimationFrame(){this.update&&(this.animationFrame=new ut((t=>this.update(t)),this.fps))}setMainLoop(t){this.gameLoop=t,this.makeAnimationFrame()}setFPS(t){this.fps=t,this.makeAnimationFrame()}update(t){var e,s;null==(e=this.stats)||e.begin(),V.tick(),Y.tick(t),this.gameLoop&&this.gameLoop(t),this.tick%rt.updateInterval==0&&rt.update(),null==(s=this.stats)||s.end(),this.tick++}start(){if(!this.gameLoop)throw new Error("No game loop");if(!this.animationFrame)throw new Error("AnimationFrame");S()?this.internalStart():window.addEventListener("DOMContentLoaded",(()=>this.internalStart()))}internalStart(){this.name&&(document.title=this.name),V.init(),Y.init(),rt.init(),this.showStatsPanel&&(this.stats=ht()),this.animationFrame.start()}}class yt{constructor(t,e){this.width=t,this.height=e}update(){}render(){}}class bt{constructor(t,e,s,i){this.x=t,this.y=e,this.width=s||100,this.height=i||s||100}collide(t){return!!(t.width&&t.height&&this.width&&this.height)&&(this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.height+this.y>t.y)}update(...t){}render(...t){}}class Zt extends bt{constructor(t,e,s,i){super(t,e,s,i)}update(...t){}render(...t){}}class xt{constructor(t,e){this.delay=t,this.callback=e,window.setTimeout(this.callback,this.delay)}}class Gt extends bt{constructor(t,e,s=5,i,n){super(e.x,e.y),this.radius=2,this.id=t,this.pos=e.clone(),this.angle=i&&"random"!=i?i%2*Math.PI:Math.PI/2+2*Math.random()*Math.PI,this.velocity=new h(Math.random()*s*Math.cos(this.angle),Math.random()*s*Math.sin(this.angle)),this.color=n||"transparent",this.opacity=y(100,255*Math.random(),255)}update(){this.velocity.y+=.01,this.pos=this.pos.add(this.velocity),this.opacity-=2}render(){pt.renderer.circle(this.pos.x,this.pos.y,this.radius,{fillStyle:this.color,lineWidth:1,globalAlpha:this.opacity/255})}}class ft{constructor(t,e,s,i){this.pos=e,this.lifeDuration=s,this.particles=[],this.UUID=100*r.randint(1,100);for(let n=0;n<t;n++){let t=new Gt(this.UUID+n,this.pos);this.particles.push(t)}new xt(this.lifeDuration,(()=>{this.destroy(),i&&i()}))}addParticles(t){return t.concat(this.particles)}removeParticles(t){const e=this.particles.length;return t.filter((t=>!b(t.id,this.UUID,this.UUID+e)))}destroy(){}}class gt{constructor(t,e){this.rows=e,this.cols=t,this.cells=[],this.focusCell=null,this.createCells(),this.defineNeighboors()}createCells(){for(let t=0;t<this.cols;t++)for(let e=0;e<this.rows;e++)this.cells.push(new wt(t,e))}updateCell(t){if(this.cells.includes(t)){if(1!==t.width||1!==t.height){if(t.width>1){let e=t.width-1,s=this.cells.filter((s=>s.y===t.y&&s.x>t.x&&s.x<=t.x+e));this.cells=this.cells.filter((t=>!s.includes(t)))}if(t.height>1){let e=t.height-1,s=this.cells.filter((s=>s.x===t.x&&s.y>t.y&&s.y<=t.y+e));this.cells=this.cells.filter((t=>!s.includes(t)))}}this.defineNeighboors(),this.cells[this.cells.indexOf(t)]=t}}defineNeighboors(){this.cells.forEach((t=>{t.neighboors.top=t.y>=1?this.cells.filter((e=>e.x<=t.x&&e.x+e.width>t.x&&e.y===t.y-t.height))[0]:null,t.neighboors.bottom=t.y<=this.rows-1?this.cells.filter((e=>e.x<=t.x&&e.x+e.width>t.x&&e.y===t.y+t.height))[0]:null,t.neighboors.left=t.x>=1?this.cells.filter((e=>e.y<=t.y&&e.y+e.height>t.y&&e.x===t.x-t.width))[0]:null,t.neighboors.right=t.x<=this.cols-1?this.cells.filter((e=>e.y<=t.y&&e.y+e.height>t.y&&e.x===t.x+t.width))[0]:null}))}get(t,e){return this.cells[t*this.cols+e]}clear(){this.cells.forEach((t=>t.state=null))}}class wt{constructor(t,e,s=1,i=1){this.x=t,this.y=e,this.width=s,this.height=i,this.state=null,this.neighboors={}}}const Wt={linear:t=>t,smoothStep:t=>(3-2*t)*t**2,smootherStep:t=>(6*t*t-15*t+10)*t**3,easeIn:t=>t**2,easeOut:t=>1-(1-t)**2,easeInOut:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInBack:t=>2.70158*t**3-1.70158*t**2,easeOutBack:t=>1+1.70158*Math.pow(t-1,3)+2.70158*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*(7.189819*t-2.5949095)/2:(Math.pow(2*t-2,2)*(3.5949095*(2*t-2)+2.5949095)+2)/2},Ct={autostart:!1,loop:!1};class Lt{constructor(t,e,s,i=Wt.linear,n={}){if(this.hasStarted=!1,this.isPaused=!1,this.isEnded=!1,this.isReversed=!1,this.lastT=0,this.from=t,this.to=e,this.duration=s,i instanceof Function)this.easing=i;else{if("string"!=typeof i||!(i in Wt))throw new Q("Unknow easing parameter","animation");this.easing=Wt[i]}this.options=o(o({},Ct),n),this.value=this.from,this.speed=(this.to-this.from)/this.duration,Y.add(this)}start(){this.isEnded=!1,this.hasStarted=!0}reset(){this.lastT=0,this.isPaused=!1}toggle(t){void 0!==t&&(t?this.pause():this.resume()),this.isPaused?this.resume():this.pause()}pause(){this.isPaused=!0}resume(){this.isPaused=!1}update(t){if(!this.hasStarted||this.isPaused)return;let e=y(0,this.lastT+t*this.speed/Math.abs(this.to-this.from),1);if(e>=1||e<=0){if(!this.options.loop)return void(this.isEnded=!0);this.speed*=-1,this.isReversed=!this.isReversed}this.lastT=e,this.value=this.from+(this.to-this.from)*this.easing(e)}get isRunning(){return this.hasStarted&&!(this.isEnded||this.isPaused)}}const vt={},Xt=1,St=!1;class Rt extends Audio{constructor(t,e={}){super(t),this.volume=e.volume||Xt,this.loop=e.loop||St,this.controls=!1}}const kt="0.4.9";export{Lt as Animation,X as ApiIsSupported,wt as Cell,vt as Config,xt as Cooldown,Wt as Easing,K as Event,pt as Game,yt as GameEnvironement,bt as GameObject,gt as Grid,rt as Interface,nt as OffscreenRenderer,Gt as Particle,ft as ParticuleGenerator,Zt as PlayerObject,u as Point,r as Random,A as Renderer,Rt as Sound,lt as Texture,kt as VERSION,m as V_NULL,p as V_UNIT,h as Vector2,g as adaptCanvasToDevicePixelRatio,W as blink,y as clamp,f as createCanvas,x as getCanvasDimensions,Z as getWindowDimensions,L as hashObject,b as inRange,w as insertCanvas,C as isWorker,v as now,G as setCanvasDimensions,S as windowIsLoaded};
